# Migration `20200115122102-add-display-name`

This migration has been generated by Matt Condon (shrugs) at 1/15/2020, 12:21:02 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "songadayworld"."MagicCode" (
    "code" text  NOT NULL ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "user" text  NOT NULL ,
    PRIMARY KEY ("code")
) 

ALTER TABLE "songadayworld"."User" DROP COLUMN "name",
ADD COLUMN "displayName" text   ;

CREATE UNIQUE INDEX "MagicCode_user" ON "songadayworld"."MagicCode"("user")

ALTER TABLE "songadayworld"."MagicCode" ADD FOREIGN KEY ("user") REFERENCES "songadayworld"."User"("id") ON DELETE RESTRICT

DROP TABLE "songadayworld"."Post";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200111111334-init..20200115122102-add-display-name
--- datamodel.dml
+++ datamodel.dml
@@ -1,25 +1,21 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("POSTGRES_URL")
 }
 generator photon {
-  provider = "photonjs"
+  provider = "prisma-client-js"
 }
-model User {
-  id    String  @default(cuid()) @id
-  email String  @unique
-  name  String?
-  posts Post[]
+model MagicCode {
+  code      String   @id
+  user      User
+  createdAt DateTime @default(now())
 }
-model Post {
-  id        String   @default(cuid()) @id
-  createdAt DateTime @default(now())
-  updatedAt DateTime @updatedAt
-  published Boolean
-  title     String
-  content   String?
-  author    User?
+model User {
+  id          String     @default(cuid()) @id
+  email       String     @unique
+  displayName String?
+  magicCode   MagicCode?
 }
```


